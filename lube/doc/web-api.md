# /

# /auth/get_privlist

获取权限表

## 请求

无请求体

## 响应

成功返回对象列表，每个元素的格式如下：

```json
{
  "id": "cIavI6qTVV0LWkS2", // 权限 ID
  "desc": "some descriptions" // 权限描述
}
```

| 情况 | 异常号 | JSON     |
| ---- | ------ | -------- |
| 成功 | 0      | 对象列表 |

# /auth/login

登录账户

## 请求

```json
{
  "id": "zhangsan", // 账户ID
  "pw": "123456" // 账户密码
}
```

## 响应

| 情况           | 异常号 | JSON |
| -------------- | ------ | ---- |
| 成功           | 0      |      |
| 账号或密码无效 | 1      |      |
| 已登录         | 2      |      |

# /auth/logout

登出用户

## 请求

无请求体

## 响应

| 情况   | 异常号 | JSON |
| ------ | ------ | ---- |
| 成功   | 0      |      |
| 未登录 | 1      |      |

# /auth/whoami

获得当前登录的账户 ID

## 请求

无请求体

## 响应

| 情况   | 异常号 | JSON              |
| ------ | ------ | ----------------- |
| 成功   | 0      | 字符串，用户的 ID |
| 未登录 | 1      |                   |

# /corpus/create

创建语料

需要权限

## 请求

```json
{
  "id": "corpus_0001", // 新语料 ID
  "content": {} // （可选）语料内容，CARBON格式对象
}
```

## 响应

| 情况        | 异常号 | JSON |
| ----------- | ------ | ---- |
| 成功        | 0      |      |
| ID 已被占用 | 1      |      |

# /corpus/delete

删除语料

需要权限

## 请求

发送一 json 字符串，为要删除语料的 ID

## 响应

| 情况      | 异常号 | JSON |
| --------- | ------ | ---- |
| 成功      | 0      |      |
| ID 不存在 | 1      |      |

# /corpus/get_content

读取语料内容

## 请求

发送一 JSON 字符串，为要查询的语料 ID

## 响应

| 情况      | 异常号 | JSON            |
| --------- | ------ | --------------- |
| 成功      | 0      | CARBON 语料对象 |
| ID 不存在 | 1      |                 |

# /corpus/get_prop

获取语料的只读属性

需要权限

## 请求

发送一 JSON 字符串，为要查询的语料 ID

## 响应

| 情况      | 异常号 | JSON                      |
| --------- | ------ | ------------------------- |
| 成功      | 0      | JSON 对象，见下方格式定义 |
| ID 不存在 | 1      |                           |

### 格式定义

```json
{
  "creator": "gyh2020", // 创建人的用户ID
  "datetime": "2020-08-04 18:53:48" // 创建时间
}
```

# /corpus/list_all

列出所有语料 ID

需要权限

## 请求

无请求体

## 响应

| 情况 | 异常号 | JSON                        |
| ---- | ------ | --------------------------- |
| 成功 | 0      | 字符串列表，为所有语料的 ID |

# /corpus/rename

改变语料 ID

## 请求

```json
{
  "old_id": "corpus_0001", // 原ID
  "new_id": "corpus_1000" // 新ID
}
```

## 响应

| 情况           | 异常号 | JSON |
| -------------- | ------ | ---- |
| 成功           | 0      |      |
| 原 ID 不存在   | 1      |      |
| 新 ID 已被占用 | 2      |      |

# /corpus/set_content

修改语料内容

## 请求

```json
{
  "id": "corpus_0001", // 语料 ID
  "content": {} // 语料内容，CARBON格式对象
}
```

## 响应

| 情况      | 异常号 | JSON |
| --------- | ------ | ---- |
| 成功      | 0      |      |
| ID 不存在 | 1      |      |

# /formatter/carbon2chtb

CARBON 转 CHTB 类型

需要权限

## 请求

发送 CARBON 格式语料对象。

## 响应

| 情况     | 异常号 | JSON                              |
| -------- | ------ | --------------------------------- |
| 成功     | 0      | JSON 字符串，内容为 CHTB 格式语料 |
| 转换失败 | 1      |                                   |

# /formatter/chtb2carbon

CHTB 转 CARBON 类型

## 请求

JSON 字符串，内容为 CHTB 格式语料

## 响应

| 情况 | 异常号 | JSON                       |
| ---- | ------ | -------------------------- |
| 成功 | 0      | JSON 对象，CARBON 语料格式 |
| 失败 | 1      |                            |

# /formatter/xin_cmn2carbon

xin_cmn 转 CARBON 类型

## 请求

JSON 字符串，内容为 CHTB 格式语料

## 响应

| 情况 | 异常号 | JSON                       |
| ---- | ------ | -------------------------- |
| 成功 | 0      | JSON 对象，CARBON 语料格式 |
| 失败 | 1      |                            |

# /raw-corpus/create

创建生语料

需要权限

## 请求

```json
{
  "id": "corpus_0001", // 新生语料 ID
  "content": {} // （可选）生语料内容，CARBON格式对象
}
```

## 响应

| 情况        | 异常号 | JSON |
| ----------- | ------ | ---- |
| 成功        | 0      |      |
| ID 已被占用 | 1      |      |

# /raw-corpus/delete

删除生语料

需要权限

## 请求

发送一 json 字符串，为要删除生语料的 ID

## 响应

| 情况      | 异常号 | JSON |
| --------- | ------ | ---- |
| 成功      | 0      |      |
| ID 不存在 | 1      |      |

# /raw-corpus/get_content

读取生语料内容

## 请求

发送一 JSON 字符串，为要查询的生语料 ID

## 响应

| 情况      | 异常号 | JSON              |
| --------- | ------ | ----------------- |
| 成功      | 0      | CARBON 生语料对象 |
| ID 不存在 | 1      |                   |

# /raw-corpus/get_prop

获取生语料的只读属性

需要权限

## 请求

发送一 JSON 字符串，为要查询的生语料 ID

## 响应

| 情况      | 异常号 | JSON                      |
| --------- | ------ | ------------------------- |
| 成功      | 0      | JSON 对象，见下方格式定义 |
| ID 不存在 | 1      |                           |

### 格式定义

```json
{
  "creator": "gyh2020", // 创建人的用户ID
  "datetime": "2020-08-04 18:53:48" // 创建时间
}
```

# /raw-corpus/list_all

列出所有生语料 ID

需要权限

## 请求

无请求体

## 响应

| 情况 | 异常号 | JSON                          |
| ---- | ------ | ----------------------------- |
| 成功 | 0      | 字符串列表，为所有生语料的 ID |

# /raw-corpus/rename

改变生语料 ID

## 请求

```json
{
  "old_id": "corpus_0001", // 原ID
  "new_id": "corpus_1000" // 新ID
}
```

## 响应

| 情况           | 异常号 | JSON |
| -------------- | ------ | ---- |
| 成功           | 0      |      |
| 原 ID 不存在   | 1      |      |
| 新 ID 已被占用 | 2      |      |

# /raw-corpus/set_content

修改生语料内容

## 请求

```json
{
  "id": "corpus_0001", // 生语料 ID
  "content": {} // 生语料内容，CARBON格式对象
}
```

## 响应

| 情况      | 异常号 | JSON |
| --------- | ------ | ---- |
| 成功      | 0      |      |
| ID 不存在 | 1      |      |

# /task/add_annotator

给任务添加标注员

## 请求

```json
{
  "tid": "task-0001", // 任务ID
  "uid": "zhangsan" // 用户ID
}
```

## 响应

| 情况                 | 异常号 | JSON |
| -------------------- | ------ | ---- |
| 成功                 | 0      |      |
| 任务 ID 不存在       | 1      |      |
| 用户 ID 重复或不存在 | 2      |      |

# /task/add_file

向任务添加文件

需要权限

## 请求

```json
{
  "tid": "task-0001", // 任务ID
  "fid": "raw_corpus-0001", // 生语料ID
  "target": "abcde" // （可选）目标入库ID，默认为生语料ID
}
```

## 响应

| 情况                   | 异常号 | JSON |
| ---------------------- | ------ | ---- |
| 成功                   | 0      |      |
| 任务 ID 不存在         | 1      |      |
| 生语料 ID 重复或不存在 | 2      |      |

# /task/commit_annotation

提交标注结果

如果用户不是任务的标注员，则需要权限

## 请求

```json
{
    "tid": "task-0001",  // 任务ID
    "fid": "file-001"    // 生语料ID
    "uid": "zhangsan"    // 标注员ID
}
```

## 响应

| 情况      | 异常号 | JSON |
| --------- | ------ | ---- |
| 成功      | 0      |      |
| ID 不存在 | 1      |      |

# /task/commit_inspection

提交审核结果

如果用户不是任务的审核员，则需要权限

## 请求

```json
{
  "tid": "task-0001", // 任务ID
  "fid": "file-001" // 生语料ID
}
```

## 响应

| 情况      | 异常号 | JSON |
| --------- | ------ | ---- |
| 成功      | 0      |      |
| ID 不存在 | 1      |      |

# /task/create

创建新任务

需要权限

## 请求

```json
{
  "id": "task-0001" // 任务 ID
}
```

## 响应

| 情况        | 异常号 | JSON |
| ----------- | ------ | ---- |
| 成功        | 0      |      |
| ID 已被占用 | 1      |      |

# /task/delete

删除任务

需要权限

## 请求

发送一 JSON 字符串，为要删除任务的 ID

## 响应

| 情况      | 异常号 | JSON |
| --------- | ------ | ---- |
| 成功      | 0      |      |
| ID 不存在 | 1      |      |

# /task/get_annotation_progress

获取标注进度

如果用户不是任务的审核员或标注员，则需要权限

标注员只能获取到自己的进度

## 请求

发送一字符串，为要查询的任务 ID

## 响应

| 情况           | 异常号 | JSON                 |
| -------------- | ------ | -------------------- |
| 成功           | 0      | 对象，见下方格式定义 |
| 任务 ID 不存在 | 1      |                      |

### 格式定义

```json
{
    "zhangsan": {
        "file-1": true,     // 键为文件ID
        "file-2": false,    // 值为false表示未提交
        "file-10: true      // 值为true表示已提交
    },
    "lisi:": {
        "file-1": true,
        "file-2": false,
        "file-10: true
    },
}
```

# /task/get_annotation_result

获取标注结果

如果用户不是任务的审核员或标注员，则需要权限

## 请求

```json
{
  "tid": "task-0001", // 任务ID
  "fid": "file-001", // 生语料ID
  "uid": "zhangsan" // 标注员ID
}
```

## 响应

| 情况      | 异常号 | JSON                   |
| --------- | ------ | ---------------------- |
| 成功      | 0      | CARBON 格式对象或 null |
| ID 不存在 | 1      |                        |

# /task/get_file_target

获取文件完成时的目标入库 ID

如果用户不是任务的审核员或标注员，则需要权限

## 请求

```json
{
  "tid": "task-0001", // 任务ID
  "fid": "file-0001" // 生语料ID
}
```

## 响应

| 情况                   | 异常号 | JSON          |
| ---------------------- | ------ | ------------- |
| 成功                   | 0      | 字符串或 null |
| 任务或生语料 ID 不存在 | 1      |               |

# /task/get_inspection_progress

获取审核进度

如果用户不是任务的审核员，则需要权限

## 请求

发送一字符串，为要查询的任务 ID

## 响应

| 情况           | 异常号 | JSON                 |
| -------------- | ------ | -------------------- |
| 成功           | 0      | 对象，见下方格式定义 |
| 任务 ID 不存在 | 1      |                      |

### 格式定义

```json
{
  "file-1": true, // 键为文件ID
  "file-2": false, // 值为false表示未提交
  "file-10": true // 值为true表示已提交
}
```

# /task/get_inspection_result

获取审核结果

如果用户不是任务的审核员，则需要权限

## 请求

```json
{
  "tid": "task-0001", // 任务ID
  "fid": "file-001" // 生语料ID
}
```

## 响应

| 情况      | 异常号 | JSON                   |
| --------- | ------ | ---------------------- |
| 成功      | 0      | CARBON 格式对象或 null |
| ID 不存在 | 1      |                        |

# /task/get_inspector

查询任务的审核员

如果用户既不是任务的审核员也不是任务的标注员，则需要权限。

## 请求

发送一字符串，为带查询任务的 ID

## 响应

| 情况           | 异常号 | JSON                    |
| -------------- | ------ | ----------------------- |
| 成功           | 0      | 字符串，为审核员用户 ID |
| 任务 ID 不存在 | 1      |                         |

# /task/get_prop

获取任务只读属性

需要权限

## 请求

发送一 JSON 字符串，为要查询的任务 ID

## 响应

| 情况      | 异常号 | JSON                      |
| --------- | ------ | ------------------------- |
| 成功      | 0      | JSON 对象，见下方格式定义 |
| ID 不存在 | 1      |                           |

### 格式定义

```json
{
  "creator": "gyh2020", // 创建人的用户ID
  "datetime": "2020-08-04 18:53:48" // 创建时间
}
```

# /task/list_all

列出所有任务

需要权限

## 请求

无请求体

## 响应

| 情况 | 异常号 | JSON                             |
| ---- | ------ | -------------------------------- |
| 成功 | 0      | JSON 字符串列表，为所有任务的 ID |

# /task/list_annotators

列出任务所有的标注员

如果用户不是任务的审核员或标注员，则需要权限

## 请求

发送一 JSON 字符串，作为待查询的任务 ID

## 响应

| 情况           | 异常号 | JSON                       |
| -------------- | ------ | -------------------------- |
| 成功           | 0      | 标注员 ID 组成的字符串列表 |
| 任务 ID 不存在 | 1      |                            |

# /task/list_by_annotator

列出用户担任标注员的任务

普通用户只能查询自己的任务列表，查询其它用户的任务列表需要权限。

## 请求

发送一 JSON 字符串，为要查询的用户 ID。

## 响应

| 情况 | 异常号 | JSON                           |
| ---- | ------ | ------------------------------ |
| 成功 | 0      | 相关任务的 ID 组成的字符串列表 |

# /task/list_by_inspector

列出用户担任审核员的任务

普通用户只能查询自己的任务列表，查询其它用户的任务列表需要权限。

## 请求

发送一 JSON 字符串，为要查询的用户 ID。

## 响应

| 情况 | 异常号 | JSON                         |
| ---- | ------ | ---------------------------- |
| 成功 | 0      | 相关任务 ID 组成的字符串列表 |

# /task/list_files

列出任务包含的所有文件

如果用户不是任务的审核员或标注员，则需要权限

## 请求

发送一 JSON 字符串，作为待查询的任务 ID

## 响应

| 情况           | 异常号 | JSON                       |
| -------------- | ------ | -------------------------- |
| 成功           | 0      | 生语料 ID 组成的字符串列表 |
| 任务 ID 不存在 | 1      |                            |

# /task/remove_annotator

移除标注员

这将会同时删除他的所有任务成果

## 请求

```json
{
  "tid": "task-0001", // 任务ID
  "uid": "zhangsan" // 标注员ID
}
```

## 响应

| 情况           | 异常号 | JSON |
| -------------- | ------ | ---- |
| 成功           | 0      |      |
| 任务 ID 不存在 | 1      |      |

# /task/remove_file

从任务移除文件

需要权限

## 请求

```json
{
  "tid": "task-0001", // 任务ID
  "fid": "raw-corpus-1" // 生语料ID
}
```

## 响应

| 情况           | 异常号 | JSON |
| -------------- | ------ | ---- |
| 成功           | 0      |      |
| 任务 ID 不存在 | 1      |      |

# /task/rename

修改任务 ID

需要权限

## 请求

```json
{
  "old_id": "task-0001", // 原任务 ID
  "new_id": "task-0002" // 新任务 ID
}
```

## 响应

| 情况        | 异常号 | JSON |
| ----------- | ------ | ---- |
| 成功        | 0      |      |
| ID 不存在   | 1      |      |
| ID 已被占用 | 2      |      |

# /task/replace_annotator

替换标注员

之前标注员的任务成果将会被保留

## 请求

```json
{
  "tid": "task-0001", // 任务ID
  "old_uid": "zhangsan", // 原标注员ID
  "new_uid": "lisi" // 新标注员ID
}
```

## 响应

| 情况           | 异常号 | JSON |
| -------------- | ------ | ---- |
| 成功           | 0      |      |
| 任务 ID 不存在 | 1      |      |

# /task/set_annotation_result

设置标注结果

如果用户不是任务的标注员，则需要权限

## 请求

```json
{
    "tid": "task-0001",  // 任务ID
    "fid": "file-001",   // 生语料ID
    "uid": "zhangsan"    // 标注员ID
    "result": {}         // CARBON格式对象，可以设为null以清空结果
}
```

## 响应

| 情况      | 异常号 | JSON |
| --------- | ------ | ---- |
| 成功      | 0      |      |
| ID 不存在 | 1      |      |

# /task/set_file_target

设置文件审核完成时的目标入库 ID

需要权限

## 请求

```json
{
    "tid": "task-0001",  // 任务ID
    "fid": "file-0001",  // 生语料ID
    "target: "chtb-01"   // 目标入库ID
}
```

## 响应

| 情况                   | 异常号 | JSON |
| ---------------------- | ------ | ---- |
| 成功                   | 0      |      |
| 任务或生语料 ID 不存在 | 1      |      |

# /task/set_inspection_result

设置审核结果

如果用户不是任务的审核员，则需要权限

## 请求

```json
{
  "tid": "task-0001", // 任务ID
  "fid": "file-001", // 生语料ID
  "result": {} // 任务结果，CARBON格式对象，可以设为null以清空结果
}
```

## 响应

| 情况      | 异常号 | JSON |
| --------- | ------ | ---- |
| 成功      | 0      |      |
| ID 不存在 | 1      |      |

# /task/set_inspector

设置任务的审核员

需要权限

## 请求

```json
{
  "tid": "task-0001", // 任务 ID
  "uid": "zhangsan" // 用户 ID
}
```

## 响应

| 情况                 | 异常号 | JSON |
| -------------------- | ------ | ---- |
| 成功                 | 0      |      |
| 任务 ID 不存在       | 1      |      |
| 用户 ID 不存在或重复 | 2      |      |

# /user/create

创建新用户

需要权限

## 请求

```json
{
  "id": "zhangsan", // 用户 ID
  "pw": "123456" // 用户密码
}
```

## 响应

| 情况        | 异常号 | JSON |
| ----------- | ------ | ---- |
| 成功        | 0      |      |
| ID 已被占用 | 1      |      |

# /user/delete

删除用户

需要权限

## 请求

发送一 json 字符串，为要删除用户的 ID

## 响应

| 情况      | 异常号 | JSON |
| --------- | ------ | ---- |
| 成功      | 0      |      |
| ID 不存在 | 1      |      |

# /user/grant_priv

授予用户权限

需要权限

## 请求

```json
{
  "uid": "zhangsan", // 用户ID
  "pid": "zbdkqezl..." // 权限ID
}
```

## 响应

| 情况           | 异常号 | JSON |
| -------------- | ------ | ---- |
| 成功           | 0      |      |
| 用户 ID 不存在 | 1      |      |

# /user/list_all

列出所有用户的 ID

需要权限

## 请求

无请求体

## 响应

| 情况 | 异常号 | JSON                        |
| ---- | ------ | --------------------------- |
| 成功 | 0      | 字符串列表，为所有用户的 ID |

# /user/list_priv

列出用户所有的权限

用户可以自由查询自己的权限，查询其他人需要权限

## 请求

发送一字符串，为用户 ID

## 响应

| 情况      | 异常号 | JSON                      |
| --------- | ------ | ------------------------- |
| 成功      | 0      | 字符串列表，元素为权限 ID |
| ID 不存在 | 1      |                           |

# /user/rename

改变用户 ID

用户可以修改自己 ID，修改其它用户的 ID 需要权限。

## 请求

```json
{
  "old_id": "zhangsan", // 原 ID
  "new_id": "lisi" // 新 ID
}
```

## 响应

| 情况        | 异常号 | JSON |
| ----------- | ------ | ---- |
| 成功        | 0      |      |
| ID 不存在   | 1      |      |
| ID 已被占用 | 2      |      |

# /user/revoke_priv

收回用户权限

需要权限

## 请求

```json
{
  "uid": "zhangsan", // 用户ID
  "pid": "zbdkqezl..." // 权限ID
}
```

## 响应

| 情况           | 异常号 | JSON |
| -------------- | ------ | ---- |
| 成功           | 0      |      |
| 用户 ID 不存在 | 1      |      |

# /user/set_pw

设置用户密码

用户可以修改自己密码，但修改他人密码需要权限。

## 请求

```json
{
  "id": "zhangsan", // 用户 ID
  "pw": "123456" // 新密码
}
```

## 响应

| 情况       | 异常号 | JSON |
| ---------- | ------ | ---- |
| 成功       | 0      |      |
| 用户不存在 | 1      |      |
